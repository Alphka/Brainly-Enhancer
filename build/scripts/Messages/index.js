(()=>{"use strict";const t=function(t){var e,n;if("string"==typeof t)e=document.createElement(t),n=arguments[1]||{};else{if("object"!=typeof t)throw new Error("args cannot be a type of "+typeof t);e=document.createElement(t.tagName),delete(n=t).tagName}return n.textContent&&(e.textContent=n.textContent),n.innerText&&(e.textContent=n.innerText),n.innerHTML&&(e.innerHTML=n.innerHTML),n.children&&n.children.forEach((function(t){return e.appendChild(t)})),delete n.textContent,delete n.innerText,delete n.innerHTML,delete n.children,Object.getOwnPropertyNames(n).forEach((function(t){return e.setAttribute(t,n[t])})),e},e=function(t,e){var n=Date.now(),s=(null==e?void 0:e.element)||document;return new Promise((function(r,i){var o=window.setInterval((function(){if(s.querySelector(t))return clearInterval(o),r(Object.assign((null==e?void 0:e.multiple)?s.querySelectorAll(t):s.querySelector(t),{isError:!1}));(null==e?void 0:e.expires)&&Date.now()>=e.expires+n&&(clearInterval(o),e.noError?r({isError:!0}):i())}))}))},n=function(){function t(){this.style=document.createElement("style"),this.updateStyle(),window.addEventListener("resize",this.updateStyle.bind(this)),document.head.appendChild(this.style)}return t.prototype.updateStyle=function(){var t=window.innerHeight;return this.style.innerHTML=("\n\t\t\t.brn-messages__conversations,\n\t\t\t.brn-messages__chatbox{\n\t\t\t\theight: "+(t-161)+"px!important;\n\t\t\t}\n\n\t\t\t.brn-messages__conversations .brn-messages__list{\n\t\t\t\theight: "+(t-260)+"px;\n\t\t\t\tmax-height: unset;\n\t\t\t\tmin-height: unset;\n\t\t\t}\n\n\t\t\t.brn-messages__chatbox .brn-chatbox__chat{\n\t\t\t\theight: "+(t-270)+"px;\n\t\t\t\tmin-height: unset;\n\t\t\t\tmax-height: unset;\n\t\t\t}\n\n\t\t\t@media (min-width: 1024px){\n\t\t\t\t.js-page-wrapper > .sg-layout > .sg-layout__container{\n\t\t\t\t\tpadding: 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.js-page-wrapper > .sg-layout > .sg-layout__container{\n\t\t\t\tmax-width: unset;\n\t\t\t\tmargin: 0!important;\n\t\t\t}\n\n\t\t\t@media (min-width: 768px){\n\t\t\t\t.sg-layout__container{\n\t\t\t\t\tborder-radius: 0!important;\n\t\t\t\t}\n\t\t\t}\n\t\t").replace(/[\n\t\r]+/g,"")},t}();var s=function(t,e,n,s){return new(n||(n=Promise))((function(r,i){function o(t){try{c(s.next(t))}catch(t){i(t)}}function a(t){try{c(s.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((s=s.apply(t,e||[])).next())}))},r=function(t,e){var n,s,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,s&&(r=2&i[0]?s.return:i[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,i[1])).done)return r;switch(s=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,s=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],s=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var s,r,i=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},o=function(t,e){for(var n=0,s=e.length,r=t.length;n<s;n++,r++)t[r]=e[n];return t};const a=function(){function n(){this.storageKey="BrainlyEnhancerFastReply",this.textarea={},this.addedCustomIcons={byId:{},all:[]},this.CreateIcons(),this.UpdatePage(),this.BindListeners()}return n.prototype.UpdatePage=function(){return s(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return this.isMenuOpened&&this.HideIconsContainer(),[4,this.SetElements()];case 1:return t.sent(),this.AppendIcons(),[2]}}))}))},n.prototype.SetElements=function(){return s(this,void 0,void 0,(function(){var t,n;return r(this,(function(s){switch(s.label){case 0:return t=this,[4,e(".brn-chatbox__footer")];case 1:return t.footer=s.sent(),n=this,[4,e(".brn-chatbox__footer .sg-textarea .sg-actions-list",{element:this.footer})];case 2:return n.container=s.sent(),[2]}}))}))},n.prototype.CreateIcons=function(){this.arrowIconContainer=this.CreateSVG("icon-arrow_up",{containerClassName:"be-arrow-icon-container"}),this.arrowIcon=this.arrowIconContainer.use},n.prototype.AppendIcons=function(){var t;null===(t=this.container.firstElementChild)||void 0===t||t.before(this.arrowIconContainer)},n.prototype.ShowIconsContainer=function(){this.isMenuOpened=!0,this.arrowIconContainer.classList.add("open");var e=[this.CreateSVG("icon-quote"),this.CreateSVG("icon-report_flag"),this.CreateSVG("icon-shield"),this.CreateSVG("icon-more")],n=i(e,4),s=n[0],r=n[1],o=n[2],a=n[3];s.svg.addEventListener("mousedown",this.IconListener.bind(this)),r.svg.addEventListener("mousedown",this.IconListener.bind(this)),o.svg.addEventListener("mousedown",this.IconListener.bind(this)),a.svg.addEventListener("mousedown",this.ToggleMoreMenu.bind(this)),this.iconsContainer=t("div",{class:"be-icons-container",children:e}),this.footer.before(this.iconsContainer)},n.prototype.IconListener=function(t){var e,n=this,i=t.target instanceof SVGUseElement?t.target:t.target.querySelector("use"),o=this.container.querySelector("textarea.sg-textarea"),a=this.container.querySelector("button.sg-button");if(i.GetMessage){var c=i.GetIconId();if(t.shiftKey)return this.OpenTextarea(c,!0);if(t.ctrlKey)return this.DeleteCustomIcon(c);e=i.GetMessage()}else{if(c=i.getAttribute("xlink:href").substr(1).split("-")[1],t.shiftKey)return this.OpenTextarea(c);e=this.GetStorage(c)}if(e){if(this.isBusy)return;return this.isBusy=!0,o.value=e,new MutationObserver((function(t,e){return s(n,void 0,void 0,(function(){return r(this,(function(t){return a.classList.contains("disabled")||(e.disconnect(),this.isBusy=!1),[2]}))}))})).observe(a,{attributes:!0}),a.click()}i.parentElement.classList.add("failure"),setTimeout((function(){return i.parentElement.classList.remove("failure")}),3e3)},n.prototype.OpenTextarea=function(e,n){var s=this;this.textarea.opened||(this.textarea.opened=!0,this.textarea.container=t("div",{id:"FastReplyOverlay",class:"sg-overlay sg-overlay--dark",children:[t("div",{class:"sg-toplayer sg-toplayer--modal sg-toplayer--large",children:[t("div",{class:"sg-toplayer__close",role:"button",tabindex:"0",children:[this.textarea.closeButton=this.CreateSVG("icon-close")]}),t("div",{class:"sg-toplayer__wrapper",children:[t("div",{class:"sg-flex sg-flex--column sg-flex--margin-l sg-flex--margin-bottom-s",children:[t("div",{class:"sg-flex sg-flex--justify-content-space-around",children:[this.textarea.element=t("textarea",{class:"sg-textarea be-textarea",placeholder:"Escreva aqui a sua mensagem",maxlength:"512"})]}),t("div",{class:"sg-flex sg-flex--align-items-center sg-flex--justify-content-center",children:[t("div",{class:"sg-flex sg-justify-content--center sg-flex--margin-top-s",children:[this.textarea.submitButton=t("div",{class:"sg-button",children:[t("span",{class:"sg-text sg-text--white",textContent:"Salvar"})]})]})]})]})]})]})]}),this.textarea.element.addEventListener("input",this.FixTextarea.bind(this)),this.textarea.container.addEventListener("click",(function(t){t.target instanceof HTMLElement&&t.target.classList.contains("sg-overlay")&&s.HideTextarea()})),"string"==typeof e&&this.GetStorage(e)?this.textarea.element.value=this.GetStorage(e):n&&this.savedIcons[e]&&(this.textarea.element.value=this.savedIcons[e]),this.textarea.submitButton.addEventListener("click",(function(t){if(!s.isCheckIcon){s.isCheckIcon=!0;var r=s.CreateSVG("icon-check",{containerClassName:"be-check-icon"});if(s.textarea.submitButton.after(r),setTimeout((function(){r.remove(),s.isCheckIcon=!1}),3e3),n){if(s.textarea.element.value.trim()){var i=s.savedIcons;return i[e]=s.textarea.element.value,s.SetStorage("savedIcons",i),s.AddCustomIcon(e)}return s.DeleteCustomIcon(e),s.HideTextarea()}s.SetStorage(e,s.textarea.element.value.trim()||void 0)}})),this.textarea.closeButton.addEventListener("click",this.HideTextarea.bind(this)),document.body.lastElementChild.after(this.textarea.container),this.FixTextarea())},n.prototype.HideTextarea=function(){this.textarea.container.remove(),this.textarea.opened=!1,this.isCheckIcon=!1,delete this.textarea.container,delete this.textarea.element,delete this.textarea.submitButton,delete this.textarea.closeButton},n.prototype.FixTextarea=function(){var t=this.textarea.element,e=t.style;t.scrollHeight>t.clientHeight?(e.borderTopRightRadius="unset",e.borderBottomRightRadius="unset"):t.removeAttribute("style")},n.prototype.ToggleMoreMenu=function(e){var n=this;this.isMoreMenuOpened="boolean"==typeof e?e:!this.isMoreMenuOpened,this.moreMenu||(this.moreMenu=t("div",{class:"be-more-menu",children:[this.iconPlus=this.CreateSVG("icon-plus")]}),Object.getOwnPropertyNames(this.savedIcons).forEach((function(t){return n.AddCustomIcon(t)})),this.iconPlus.addEventListener("click",(function(t){if(!n.iconPlus.classList.contains("maxlength")){var e=Object.getOwnPropertyNames(n.savedIcons).filter((function(t){return function(t){if(!t||!["number","string"].includes(typeof t)||!String(t).length)return!1;var e=Number(t);return Number.isFinite(e)&&!Number.isNaN(e)}(t)})).map((function(t){return Number(t)})),s=Number.isFinite(Math.max.apply(Math,o([],i(e))))?Math.max.apply(Math,o([],i(e))):0;n.OpenTextarea(s+1,!0)}})),3===this.savedIcons.length&&this.iconPlus.classList.add("maxlength")),this.isMoreMenuOpened?this.moreMenu.classList.add("open"):this.moreMenu.classList.remove("open"),this.iconsContainer.appendChild(this.moreMenu)},n.prototype.HideIconsContainer=function(){this.isMenuOpened=!1,this.isMoreMenuOpened=!1,this.arrowIconContainer.classList.remove("open"),this.iconsContainer.remove()},n.prototype.AddCustomIcon=function(e,n){var s=this;if(this.addedCustomIcons.byId[e])n&&this.moreMenu.appendChild(this.addedCustomIcons.byId[e]);else{var r=this.CreateSVG("icon-settings");this.addedCustomIcons.byId[e]=r,this.addedCustomIcons.all.push(r),r.use.GetMessage=function(){return s.savedIcons[e]},r.use.GetIconId=function(){return e},r.svg.addEventListener("click",this.IconListener.bind(this));var i=!1;r.svg.addEventListener("mouseenter",(function(e){var n;if(!i){i=!0,setTimeout((function(){return i=!1}),1e3),null===(n=document.querySelector("#TitleText"))||void 0===n||n.remove();var s=t("span",{id:"TitleText",style:"top: "+(e.y-60)+"px; left: "+e.x+"px;",textContent:r.use.GetMessage()});r.svg.addEventListener("mouseleave",(function(){return s.remove()}),{once:!0}),setTimeout((function(){return s.remove()}),5e3),document.body.appendChild(s)}})),this.iconPlus.classList[3===this.savedIcons.length?"add":"remove"]("maxlength"),this.moreMenu.appendChild(r)}},n.prototype.DeleteCustomIcon=function(t){var e,n=this.savedIcons;void 0!==n[t]&&(delete n[t],this.SetStorage("savedIcons",n),null===(e=document.querySelector("#TitleText"))||void 0===e||e.remove(),this.addedCustomIcons.byId[t].remove(),this.addedCustomIcons.all.splice(this.addedCustomIcons.all.indexOf(this.addedCustomIcons.byId[t]),1),delete this.addedCustomIcons.byId[t],this.iconPlus.classList[3===this.savedIcons.length?"add":"remove"]("maxlength"))},n.prototype.CreateSVG=function(e,n){var s,r,a;void 0===n&&(n={});var c=t("div",{class:"sg-icon sg-icon--gray-secondary sg-icon--x"+(n.svgSize||24)}),l=document.createElementNS("http://www.w3.org/2000/svg","svg"),u=document.createElementNS("http://www.w3.org/2000/svg","use");return n.containerClassName&&(s=c.classList).add.apply(s,o([],i(n.containerClassName.split(" ")))),n.svgClassName&&(r=l.classList).add.apply(r,o([],i(n.svgClassName.split(" ")))),n.useClassName&&(a=u.classList).add.apply(a,o([],i(n.useClassName.split(" ")))),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+e),l.classList.add("sg-icon__svg"),l.appendChild(u),c.appendChild(l),Object.assign(c,{svg:l,use:u})},n.prototype.BindListeners=function(){return s(this,void 0,void 0,(function(){var t,n=this;return r(this,(function(s){switch(s.label){case 0:return[4,e("#private-messages-container")];case 1:return t=s.sent(),new MutationObserver((function(t,e){t.some((function(t){if(t.target instanceof HTMLElement)return"private-messages-container"===t.target.id}))&&n.UpdatePage()})).observe(t,{childList:!0}),this.arrowIconContainer.addEventListener("click",(function(t){n.isMenuOpened?n.HideIconsContainer():n.ShowIconsContainer()})),[2]}}))}))},n.prototype.GetStorage=function(t){var e,n=this,s=localStorage.getItem(this.storageKey),r=function(){localStorage.setItem(n.storageKey,"{}"),e={}};if(s)try{if(!((e=JSON.parse(s))instanceof Object))throw"Invalid value"}catch(t){BrainlyEnhancer.Error(t),r()}else r();return t?e[t]:e},n.prototype.SetStorage=function(t,e){if(!t)throw new Error("No key provided");var n=this.GetStorage();n[t]=e,localStorage.setItem(this.storageKey,JSON.stringify(n))},Object.defineProperty(n.prototype,"savedIcons",{get:function(){var t=this.GetStorage("savedIcons");return t instanceof Object&&length<=3?Object.setPrototypeOf(t,{length:Object.getOwnPropertyNames(t).length}):Object.setPrototypeOf({},{length:0})},enumerable:!1,configurable:!0}),n}();var c;("expandLayout",void 0===c&&(c="local"),new Promise((function(t){chrome.runtime.sendMessage(BrainlyEnhancer.extension.id,{action:"getStorage",data:{keys:"expandLayout",type:c}},t)}))).then((function(t){return t&&new n})),new a})();